import{B as a}from"./base-DuxA1QPW.js";import{B as t,a as r,g as m,b as n}from"./index-CjjyKBHd.js";import"./index-8m48hVje.js";class d extends a{constructor(){super(...arguments),this.biometryType=t.none,this.biometryTypes=[],this.biometryIsEnrolled=!1,this.deviceIsSecure=!1}async checkBiometry(){const e=this.biometryType!==t.none,i=e&&this.biometryIsEnrolled;let o="",s=r.none;return e?this.biometryIsEnrolled||(o="Biometry is not enrolled",s=r.biometryNotEnrolled):(o="No biometry is available",s=r.biometryNotAvailable),{isAvailable:i,strongBiometryIsAvailable:this.biometryIsEnrolled&&this.hasStrongBiometry(),biometryType:this.biometryType,biometryTypes:this.biometryTypes,deviceIsSecure:this.deviceIsSecure,reason:o,code:s}}hasStrongBiometry(){return this.biometryTypes.some(e=>e===t.faceId||e===t.touchId||e===t.fingerprintAuthentication)}async internalAuthenticate(e){const i=await this.checkBiometry();if(!(i.isAvailable&&confirm((e==null?void 0:e.reason)||`Authenticate with ${i.biometryTypes.map(o=>m(o)).join(" or ")}?`))){if(e!=null&&e.allowDeviceCredential){if(i.deviceIsSecure){if(confirm("Authenticate with device security?"))return;throw new n("User cancelled",r.userCancel)}else if(i.isAvailable)throw new n("Device is not secure",r.noDeviceCredential)}else if(!i.isAvailable)throw i.biometryType===t.none?new n("Biometry is not available",r.biometryNotAvailable):new n("Biometry is not enrolled",r.biometryNotEnrolled);throw new n("User cancelled",r.userCancel)}}async setBiometryType(e){if(e===void 0)return;const i=Array.isArray(e)?e:[e];if(this.biometryTypes=[],this.biometryType=t.none,i.length!==0)if(c(i))this.biometryType=i[0],this.biometryType!==t.none&&(this.biometryTypes=i);else for(const[o,s]of i.entries())l(s)&&(this.biometryType===t.none?this.biometryTypes=[]:this.biometryTypes.push(s),o===0&&(this.biometryType=s))}async setBiometryIsEnrolled(e){this.biometryIsEnrolled=e}async setDeviceIsSecure(e){this.deviceIsSecure=e}}function l(y){return Object.values(t).includes(y)}function c(y){return y.every(e=>l(e))}export{d as BiometricAuthWeb};
